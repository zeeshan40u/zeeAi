<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZeeAi 1.3</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="https://image.jimcdn.com/app/cms/image/transf/none/path/s87e10734edef81fd/image/ic057f555847bdd10/version/1757224479/image.jpg">
  <meta name="theme-color" content="#00ff55" id="themeColor">

  <style>
/* ------------------------
   Global fixes
------------------------ */
* {
  -webkit-tap-highlight-color: transparent; /* removes blue tap highlight */
  user-select: none; /* disable text selection */
}

input, textarea {
  user-select: text; /* allow typing/copying in inputs */
}

/* ------------------------
   Splash Screen
------------------------ */
#splash-screen {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.splash-logo {
  width: 150px;
  height: auto;
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); opacity: 0.8; }
  50% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(1); opacity: 0.8; }
}

/* --- THEME VARIABLES --- */
:root {
  --bg-dark: #0d0d0d;
  --text-dark: #e0e0e0;
  --heading-dark: #00ff55;
  --accent-dark: #00ccee;
  --container-dark: rgba(18, 18, 18, 0.9);
  --container-border-dark: rgba(0, 255, 85, 0.3);
  --container-shadow-dark: 0 0 25px rgba(0, 255, 85, 0.12);

  --bg-light: #ffffff;
  --text-light: #111111;
  --heading-light: #0066ff;
  --accent-light: #0066ff;
  --container-light: #ffffff;
  --container-border-light: rgba(0, 102, 255, 0.12);
  --container-shadow-light: 0 6px 18px rgba(0, 0, 0, 0.06);

  --bg-teal: #0f1111;
  --text-teal: #d7eaea;
  --heading-teal: #20c997;
  --accent-teal: #17a2b8;
  --container-teal: #1c1f1f;
  --container-border-teal: rgba(23, 162, 184, 0.4);
  --container-shadow-teal: 0 0 20px rgba(23, 162, 184, 0.2);

  --bg-gold: #000000;
  --text-gold: #f8f5e1;
  --heading-gold: #ffd700;
  --accent-gold: #ffae00;
  --container-gold: #111111;
  --container-border-gold: rgba(255, 215, 0, 0.4);
  --container-shadow-gold: 0 0 20px rgba(255, 215, 0, 0.2);

  --bg: var(--bg-dark);
  --text: var(--text-dark);
  --heading: var(--heading-dark);
  --accent: var(--accent-dark);
  --container-bg: var(--container-dark);
  --container-border: var(--container-border-dark);
  --container-shadow: var(--container-shadow-dark);
  --grid-rgb: 30, 255, 12;
}

/* Theme body classes */
body.theme-dark {
  --bg: var(--bg-dark);
  --text: var(--text-dark);
  --heading: var(--heading-dark);
  --accent: var(--accent-dark);
  --container-bg: var(--container-dark);
  --container-border: var(--container-border-dark);
  --container-shadow: var(--container-shadow-dark);
  --grid-rgb: 30, 255, 12;
}

body.theme-light {
  --bg: var(--bg-light);
  --text: var(--text-light);
  --heading: var(--heading-light);
  --accent: var(--accent-light);
  --container-bg: var(--container-light);
  --container-border: var(--container-border-light);
  --container-shadow: var(--container-shadow-light);
  --grid-rgb: 0, 102, 255;
}

body.theme-teal {
  --bg: var(--bg-teal);
  --text: var(--text-teal);
  --heading: var(--heading-teal);
  --accent: var(--accent-teal);
  --container-bg: var(--container-teal);
  --container-border: var(--container-border-teal);
  --container-shadow: var(--container-shadow-teal);
  --grid-rgb: 23, 162, 184;
}

body.theme-gold {
  --bg: var(--bg-gold);
  --text: var(--text-gold);
  --heading: var(--heading-gold);
  --accent: var(--accent-gold);
  --container-bg: var(--container-gold);
  --container-border: var(--container-border-gold);
  --container-shadow: var(--container-shadow-gold);
  --grid-rgb: 255, 215, 0;
}

/* ------------------------
   Body & general styles
------------------------ */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Consolas", "Monaco", "Lucida Console", monospace;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  transition: background 0.6s ease, color 0.6s ease;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: -1;
  background-image: linear-gradient(0deg, transparent 24%, rgba(var(--grid-rgb), 0.05) 25%, rgba(var(--grid-rgb), 0.05) 26%, transparent 27%, transparent 74%, rgba(var(--grid-rgb), 0.05) 75%, rgba(var(--grid-rgb), 0.05) 76%, transparent 77%, transparent),
                    linear-gradient(90deg, transparent 24%, rgba(var(--grid-rgb), 0.05) 25%, rgba(var(--grid-rgb), 0.05) 26%, transparent 27%, transparent 74%, rgba(var(--grid-rgb), 0.05) 75%, rgba(var(--grid-rgb), 0.05) 76%, transparent 77%, transparent);
  background-size: 50px 50px;
  opacity: 0.18;
  transition: background-image 0.8s ease, opacity 0.6s ease;
}

.page {
  min-height: calc(100vh - 6vh);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 5vh 16px;
}

.content {
  width: 100%;
  max-width: 720px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.heading {
  width: 100%;
  text-align: center;
  font-size: clamp(1.6rem, 6vw, 3rem);
  font-weight: 700;
  letter-spacing: 2px;
  color: var(--heading);
  margin: 0;
  animation: subtlePulse 2s infinite alternate ease-in-out;
  transition: color 0.6s ease, text-shadow 0.6s ease;
}

@keyframes subtlePulse {
  from { transform: scale(1); }
  to { transform: scale(1.01); }
}

body.theme-dark .heading, body.theme-gold .heading {
  text-shadow: 0 0 6px var(--heading), 0 0 14px rgba(0, 0, 0, 0.06);
}

/* Container */
.container {
  width: 95%;
  padding: 18px;
  background: var(--container-bg);
  border-radius: 12px;
  border: 1px solid var(--container-border);
  box-shadow: var(--container-shadow);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 12px;
  transition: background 0.6s ease, box-shadow 0.6s ease, border-color 0.6s ease;
}

/* Labels & textarea */
label[for="txt"] {
  font-size: 0.95rem;
  color: var(--text);
  margin-bottom: 6px;
  display: block;
}

#txt {
  width: 100%;
  padding: 12px;
  font-size: 1.05rem;
  border-radius: 8px;
  border: 1px solid var(--container-border);
  background: transparent;
  color: var(--text);
  min-height: 140px;
  resize: vertical;
  box-sizing: border-box;
}

#txt:focus {
  outline: none;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
  border-color: var(--accent);
}

/* Controls & buttons */
.controls {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: center;
  width: 100%;
}

.enter {
  padding: 12px 20px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(45deg, var(--accent) 0%, var(--heading) 50%, var(--accent) 100%);
  background-size: 300% 300%;
  animation: buttonGlow 6s ease infinite;
  color: var(--bg);
  font-weight: 700;
  letter-spacing: 1px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.18);
  transition: transform 200ms ease;
}

@keyframes buttonGlow {
  0% { background-position: 0% 50% }
  50% { background-position: 100% 50% }
  100% { background-position: 0% 50% }
}

.enter:active {
  transform: translateY(1px) scale(0.995);
}

/* Theme Picker */
#themeToggle {
  position: fixed;
  top: 14px;
  right: 14px;
  z-index: 1200;
  width: 60px;
  height: 60px;
  font-size: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--container-bg);
  border: 1px solid var(--container-border);
  outline: none;
  border-radius: 12px;
  cursor: pointer;
  user-select: none;
  color: var(--text);
  box-shadow: var(--container-shadow);
  transition: background 0.6s ease, border-color 0.6s ease, box-shadow 0.6s ease;
}

.theme-menu {
  position: fixed;
  top: 80px;
  right: 12px;
  z-index: 1250;
  padding: 8px;
  border-radius: 10px;
  background: var(--container-bg);
  border: 1px solid var(--container-border);
  box-shadow: var(--container-shadow);
  display: none;
  flex-direction: column;
  gap: 8px;
  min-width: 180px;
}

.theme-option {
  display: flex;
  gap: 10px;
  align-items: center;
  padding: 8px;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 120ms ease, background 250ms ease;
  border: 1px solid transparent;
}

.theme-option:hover {
  transform: translateY(-3px);
  background: rgba(255, 255, 255, 0.02);
}

.swatch {
  width: 34px;
  height: 34px;
  border-radius: 8px;
  flex-shrink: 0;
  border: 1px solid rgba(255, 255, 255, 0.06);
}

.theme-label {
  color: var(--text);
  font-weight: 600;
  font-size: 0.95rem;
}

/* Speed Controller */
#speedControl {
  position: fixed;
  bottom: 92px;
  right: 18px;
  z-index: 1200;
}

#speedBtn {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  background: var(--accent);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #000;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.18);
}

#speedMenu {
  display: none;
  position: absolute;
  bottom: 54px;
  right: 0;
  background: var(--container-bg);
  border: 1px solid var(--container-border);
  border-radius: 8px;
  padding: 6px;
  box-shadow: var(--container-shadow);
  flex-direction: column;
  gap: 6px;
}

#speedMenu button {
  background: var(--accent);
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 700;
  color: #111;
}

*:focus,
*:focus-visible,
:active,
:hover {
  outline: none !important;
  box-shadow: none !important;
}
  </style>
</head>

<body class="theme-dark">

<!-- Splash Screen -->
<div id="splash-screen">
  <img src="zee512.png" alt="ZeeAI Logo" class="splash-logo">
</div>

<!-- App container -->
<div id="app" style="display:none;">
  <div class="page">
    <div class="content">
      <h1 class="heading">ZeeAi 1.3</h1>
      <div class="container">
        <label for="txt">Enter Text</label>
        <textarea id="txt" placeholder="Type text to speak..."></textarea>
        <div class="controls" style="width:100%; justify-content:space-between; gap:8px;">
          <button id="speakBtn" class="enter">Speak</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Theme Toggle -->
<button id="themeToggle" title="Theme">🎨</button>
<div id="themeMenu" class="theme-menu">
  <div class="theme-option" data-theme="theme-dark">
    <div class="swatch" style="background:linear-gradient(45deg,#00ff55,#00ccee)"></div>
    <div class="theme-label">Green & Black</div>
  </div>
  <div class="theme-option" data-theme="theme-light">
    <div class="swatch" style="background:linear-gradient(45deg,#0066ff,#00a6ff)"></div>
    <div class="theme-label">Blue & White</div>
  </div>
  <div class="theme-option" data-theme="theme-teal">
    <div class="swatch" style="background:linear-gradient(45deg,#20c997,#17a2b8)"></div>
    <div class="theme-label">Teal & Gray</div>
  </div>
  <div class="theme-option" data-theme="theme-gold">
    <div class="swatch" style="background:linear-gradient(45deg,#ffd700,#ffae00)"></div>
    <div class="theme-label">Gold & Black</div>
  </div>
</div>

<!-- Speed Controller -->
<div id="speedControl">
  <button id="speedBtn">⚡</button>
  <div id="speedMenu">
    <button data-speed="0.5">0.5x</button>
    <button data-speed="1">1x</button>
    <button data-speed="1.5">1.5x</button>
    <button data-speed="2">2x</button>
  </div>
</div>
<script>
/* ------------------------
   Service Worker register
   ------------------------ */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js').catch(()=>{});
}

/* ------------------------
   Splash Screen
   ------------------------ */
window.addEventListener("load", () => {
  // If offline from start → redirect to offline.html
  if (!navigator.onLine) {
    window.location.href = "offline.html";
    return;
  }

  // Else → run splash animation
  setTimeout(() => {
    const splash = document.getElementById("splash-screen");
    splash.style.opacity = "0";
    setTimeout(() => {
      splash.style.display = "none";
      document.getElementById("app").style.display = "block";
    }, 600);
  }, 1200);
});

/* ------------------------
   Theme toggle + persistence
   ------------------------ */
const themeToggle = document.getElementById('themeToggle');
const speakBtn = document.getElementById('speakBtn');
const txtInput = document.getElementById('txt');
const speedBtn = document.getElementById('speedBtn');
const speedMenu = document.getElementById('speedMenu');
const themeMenu = document.getElementById('themeMenu');
const themeOptions = themeMenu.querySelectorAll('.theme-option');
const themeColorMeta = document.getElementById('themeColor');

const themeMetaColors = {
  'theme-dark': '#00ff55',
  'theme-light': '#0066ff',
  'theme-teal': '#20c997',
  'theme-gold': '#ffd700'
};

// Load saved theme
function applyTheme(themeName){
  document.body.classList.remove('theme-dark','theme-light','theme-teal','theme-gold');
  document.body.classList.add(themeName);
  localStorage.setItem('zeeai-theme', themeName);
  themeColorMeta.setAttribute('content', themeMetaColors[themeName]);
}
applyTheme(localStorage.getItem('zeeai-theme') || 'theme-dark');

// Theme toggle
themeToggle.addEventListener('click', e=>{
  e.stopPropagation();
  themeMenu.style.display = themeMenu.style.display==='flex' ? 'none':'flex';
});

document.addEventListener('click', e=>{
  if(!themeMenu.contains(e.target) && e.target!==themeToggle){
    themeMenu.style.display='none';
  }
});

themeOptions.forEach(opt=>{
  opt.addEventListener('click', ()=>{
    applyTheme(opt.dataset.theme);
    themeMenu.style.display='none';
  });
});

/* ------------------------
   TTS + number-processing + Speak/Stop
   ------------------------ */
let isSpeaking = false;
let currentUtterance = null;
let currentRate = 1;

// Speed Controller Logic
if (speedBtn) {
  speedBtn.addEventListener('click', e=>{
    e.stopPropagation();
    if (speedMenu) speedMenu.style.display = speedMenu.style.display==='flex' ? 'none':'flex';
  });
}
document.addEventListener('click', e=>{
  if(speedMenu && !speedMenu.contains(e.target) && e.target!==speedBtn){
    speedMenu.style.display='none';
  }
});

if (speedMenu) {
  speedMenu.querySelectorAll('button').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      currentRate = parseFloat(btn.dataset.rate);
      speedMenu.style.display='none';
    });
  });
}

const digitWords = ['zero','one','two','three','four','five','six','seven','eight','nine'];

function spellDigitsString(numStr){
  return numStr.split('').map(ch => {
    if (/\d/.test(ch)) return digitWords[parseInt(ch,10)];
    return ch;
  }).join(' ');
}

function processTextForSpeech(input){
  const trimmed = input.trim();
  if (!trimmed) return '';

  const words = trimmed.split(/\s+/);
  if (/^1000$/.test(trimmed)) return 'one thousand';
  if (/^10000$/.test(trimmed)) return spellDigitsString('10000');

  if (words.length > 4) {
    return trimmed.replace(/\d+/g, match => spellDigitsString(match));
  }

  let out = trimmed.replace(/\b1000\b/g, 'one thousand');
  out = out.replace(/\b10000\b/g, (m)=> spellDigitsString(m));
  return out;
}

function speakHandler(){
  const inputText = txtInput.value || '';
  if (isSpeaking) {
    window.speechSynthesis.cancel();
    resetSpeakingState();
    return;
  }
  const processed = processTextForSpeech(inputText);
  if (!processed.trim()){
    alert('Please enter some text!');
    return;
  }

  currentUtterance = new SpeechSynthesisUtterance(processed);
  currentUtterance.rate = currentRate; 

  currentUtterance.onstart = () => {
    isSpeaking = true;
    speakBtn.textContent = 'Stop';
    document.getElementById('returnedText')?.classList?.add('visible');
  };
  currentUtterance.onend = resetSpeakingState;
  currentUtterance.onerror = resetSpeakingState;

  const returned = document.getElementById('returnedText');
  if (returned) {
    returned.textContent = `Speaking: "${processed}"`;
    returned.classList.add('visible');
  }

  window.speechSynthesis.speak(currentUtterance);
}

function resetSpeakingState(){
  isSpeaking = false;
  speakBtn.textContent = 'Speak';
  const returned = document.getElementById('returnedText');
  if (returned) returned.classList.remove('visible');
  currentUtterance = null;
}

if (speakBtn) speakBtn.addEventListener('click', speakHandler);
if (txtInput) {
  txtInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      speakHandler();
    }
  });
}
</script>
</body>
</html>