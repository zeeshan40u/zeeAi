<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offline Mode - ZeeAi</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #eee;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
      overflow: hidden;
    }

    .container {
      max-width: 300px;
      padding: 15px;
    }

    h1 { color: #00ff55; }

    button {
      background-color: #00ff55;
      color: #111;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }

    button:hover { background-color: #00cc44; }

    .game-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.95);
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }

    canvas {
      background: #222;
      border: 2px solid #00ff55;
      border-radius: 12px;
    }

    .close-btn {
      margin-top: 20px;
      background-color: #ff4444;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }

    .score-display {
      color: #0f0;
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
    }

    .game-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #00ff55;
      color: #111;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 999;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>You‚Äôre Offline</h1>
    <p>Please check your internet connection and try again.</p>
    <button onclick="location.reload()">üîÑ Try Again</button>
  </div>

  <button class="game-button" onclick="openGame()">üéÆ Play Game</button>

  <div class="game-overlay" id="gameOverlay">
    <canvas id="racing-canvas" width="320" height="500"></canvas>
    <div id="score" class="score-display">Score: 0</div>
    <div id="high-score" class="score-display">High Score: 0</div>
    <button class="close-btn" onclick="closeGame()">‚ùå Close Game</button>
  </div>

  <script>
const overlay = document.getElementById("gameOverlay");
const canvas = document.getElementById("racing-canvas");
const ctx = canvas.getContext("2d");
const PIXEL_SIZE = 5; // smaller, more detailed cars
let player, obstacles, score, highScore, gameOver, obstacleSpeed, keys = {}, nitroActive = false, nitroTimer = 0;

// ---- Pixelated Car Designs ----
// Player: Mercedes
const playerCarDesign = [
  ['T','T','B','B','B','T','T'],
  ['T','B','W','W','W','B','T'],
  ['B','W','G','G','G','W','B'],
  ['B','W','G','G','G','W','B'],
  ['T','B','W','W','W','B','T'],
  ['T','T','B','B','B','T','T']
];

// Opponent: BMW
const opponentCarDesign = [
  ['T','R','R','R','R','R','T'],
  ['R','W','W','W','W','W','R'],
  ['R','B','B','B','B','B','R'],
  ['R','B','B','B','B','B','R'],
  ['R','W','W','W','W','W','R'],
  ['T','R','R','R','R','R','T']
];

const colors = {
  'B': '#0000FF', 'R': '#FF0000', 'T':'#00000000', 'W':'#FFFFFF', 'G':'#00FF00'
};

// ---- Game Functions ----
function drawCar(x, y, design) {
  for(let row=0; row<design.length; row++){
    for(let col=0; col<design[row].length; col++){
      const color = design[row][col];
      if(color !== 'T'){
        ctx.fillStyle = colors[color] || '#000';
        ctx.fillRect(x + col*PIXEL_SIZE, y + row*PIXEL_SIZE, PIXEL_SIZE, PIXEL_SIZE);
      }
    }
  }
}

function startGame(){
  player = { x: canvas.width/2 - 17, y: canvas.height - 80, width: playerCarDesign[0].length*PIXEL_SIZE, height: playerCarDesign.length*PIXEL_SIZE };
  obstacles = [];
  score = 0;
  highScore = localStorage.getItem("highScore") || 0;
  gameOver = false;
  obstacleSpeed = 2;
  nitroActive = false;
  nitroTimer = 0;
  document.getElementById("score").innerText = `Score: ${score}`;
  document.getElementById("high-score").innerText = `High Score: ${highScore}`;
  requestAnimationFrame(updateGame);
}

function spawnObstacle(){
  const width = opponentCarDesign[0].length * PIXEL_SIZE;
  const height = opponentCarDesign.length * PIXEL_SIZE;
  const minX = 10;
  const maxX = canvas.width - width - 10;
  const x = Math.random()*(maxX-minX)+minX;
  obstacles.push({ x: x, y: -height, width: width, height: height, passed: false });
}

function updateGame(){
  if(gameOver) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Move obstacles
  for(let obs of obstacles){
    obs.y += obstacleSpeed * (nitroActive ? 2 : 1);
    drawCar(obs.x, obs.y, opponentCarDesign);
    if(!obs.passed && obs.y > player.y + player.height){
      score++; obs.passed = true;
      document.getElementById("score").innerText = `Score: ${score}`;
    }
  }

  obstacles = obstacles.filter(o => o.y < canvas.height + 20);
  if(Math.random()<0.02) spawnObstacle();

  // Player
  drawCar(player.x, player.y, playerCarDesign);

  // Collision
  for(let obs of obstacles){
    if(player.x < obs.x + obs.width &&
       player.x + player.width > obs.x &&
       player.y < obs.y + obs.height &&
       player.y + player.height > obs.y){
      endGame(); return;
    }
  }

  // Nitro timer
  if(nitroActive){
    nitroTimer--;
    if(nitroTimer <= 0) nitroActive = false;
  }

  // Player controls
  if(keys["ArrowLeft"]) player.x = Math.max(player.x-3,0);
  if(keys["ArrowRight"]) player.x = Math.min(player.x+3, canvas.width - player.width);

  requestAnimationFrame(updateGame);
}

function endGame(){
  gameOver = true;
  ctx.fillStyle = '#0F0';
  ctx.font = '20px Arial';
  ctx.fillText("Game Over!", canvas.width/2 - 50, canvas.height/2);
  ctx.fillText(`Score: ${score}`, canvas.width/2 - 40, canvas.height/2 + 30);
  if(score > highScore){ highScore = score; localStorage.setItem("highScore", highScore); }
  document.getElementById("high-score").innerText = `High Score: ${highScore}`;
}

// Controls
document.addEventListener("keydown", e => { keys[e.key] = true; });
document.addEventListener("keyup", e => { keys[e.key] = false; });

// Touch Buttons
function addGameControls(){
  const leftBtn = document.createElement("button");
  leftBtn.innerText = "‚¨ÖÔ∏è";
  leftBtn.style.cssText = "position:fixed; bottom:10px; left:10px; width:60px; height:60px; font-size:24px; border-radius:50%; z-index:1000;";
  leftBtn.addEventListener("touchstart",()=>keys["ArrowLeft"]=true);
  leftBtn.addEventListener("touchend",()=>keys["ArrowLeft"]=false);
  document.body.appendChild(leftBtn);

  const rightBtn = document.createElement("button");
  rightBtn.innerText = "‚û°Ô∏è";
  rightBtn.style.cssText = "position:fixed; bottom:10px; left:80px; width:60px; height:60px; font-size:24px; border-radius:50%; z-index:1000;";
  rightBtn.addEventListener("touchstart",()=>keys["ArrowRight"]=true);
  rightBtn.addEventListener("touchend",()=>keys["ArrowRight"]=false);
  document.body.appendChild(rightBtn);

  const nitroBtn = document.createElement("button");
  nitroBtn.innerText = "‚ö° Nitro";
  nitroBtn.style.cssText = "position:fixed; bottom:10px; right:10px; width:100px; height:60px; font-size:18px; border-radius:12px; z-index:1000;";
  nitroBtn.addEventListener("touchstart",()=>{ nitroActive=true; nitroTimer=360; }); // 6 seconds at 60fps
  document.body.appendChild(nitroBtn);
}

function openGame(){ overlay.style.display="flex"; startGame(); addGameControls(); }
function closeGame(){ overlay.style.display="none"; }
</script>
</body>
</html>