<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offline Mode - ZeeAi</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #eee;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
      overflow: hidden;
    }

    .container {
      max-width: 300px;
      padding: 15px;
    }

    h1 { color: #00ff55; }

    button {
      background-color: #00ff55;
      color: #111;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }

    button:hover { background-color: #00cc44; }

    .game-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.95);
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }

    canvas {
      background: #222;
      border: 2px solid #00ff55;
      border-radius: 12px;
    }

    .close-btn {
      margin-top: 20px;
      background-color: #ff4444;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }

    .score-display {
      color: #0f0;
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
    }

    .game-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #00ff55;
      color: #111;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 999;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>You‚Äôre Offline</h1>
    <p>Please check your internet connection and try again.</p>
    <button onclick="location.reload()">üîÑ Try Again</button>
  </div>

  <button class="game-button" onclick="openGame()">üéÆ Play Game</button>

  <div class="game-overlay" id="gameOverlay">
    <canvas id="racing-canvas" width="320" height="500"></canvas>
    <div id="score" class="score-display">Score: 0</div>
    <div id="high-score" class="score-display">High Score: 0</div>
    <button class="close-btn" onclick="closeGame()">‚ùå Close Game</button>
  </div>

  <script>  
const overlay = document.getElementById("gameOverlay");  
const canvas = document.getElementById("racing-canvas");  
const ctx = canvas.getContext("2d");  
const PIXEL_SIZE = 6; // increased pixel size for more detailed cars  
let player, obstacles, score, highScore, gameOver, obstacleSpeed, keys = {},  
    playerBaseSpeed = 4, playerSpeed = 4,  
    nitroActive = false, nitroDuration = 0, nitroCooldown = 0;  
  
const NITRO_DURATION_FRAMES = 180; // 3 seconds  
const NITRO_COOLDOWN_FRAMES = 540; // 9 seconds  
  
let leftBtn, rightBtn, nitroBtn;  
  
// --- Cars ---  
// Player: Mercedes (8x6)  
const playerCarDesign = [  
  ['T','T','B','B','B','B','T','T'],  
  ['T','B','W','W','W','W','B','T'],  
  ['B','G','G','G','G','G','G','B'],  
  ['B','G','G','G','G','G','G','B'],  
  ['B','G','G','G','G','G','G','B'],  
  ['T','B','W','W','W','W','B','T']  
];  
  
// Opponent: BMW (8x6)  
const opponentCarDesign = [  
  ['T','R','R','R','R','R','T','T'],  
  ['R','W','W','W','W','W','R','T'],  
  ['R','B','B','B','B','B','B','R'],  
  ['R','B','B','B','B','B','B','R'],  
  ['R','W','W','W','W','W','R','T'],  
  ['T','R','R','R','R','R','T','T']  
];  
  
const colors = {'B':'#0000FF','R':'#FF0000','T':'#00000000','W':'#FFFFFF','G':'#00FF00'};  
  
function drawCar(x, y, design){  
  for(let row=0; row<design.length; row++){  
    for(let col=0; col<design[row].length; col++){  
      const color = design[row][col];  
      if(color!=='T'){  
        ctx.fillStyle = colors[color] || '#000';  
        ctx.fillRect(x + col*PIXEL_SIZE, y + row*PIXEL_SIZE, PIXEL_SIZE, PIXEL_SIZE);  
      }  
    }  
  }  
}  
  
function startGame(){  
  player = {x: canvas.width/2 - 24, y: canvas.height-100, width: playerCarDesign[0].length*PIXEL_SIZE, height: playerCarDesign.length*PIXEL_SIZE};  
  obstacles = [];  
  score = 0;  
  highScore = localStorage.getItem("highScore") || 0;  
  gameOver = false;  
  obstacleSpeed = 3;  
  playerSpeed = playerBaseSpeed;  
  nitroActive = false;  
  nitroDuration = 0;  
  nitroCooldown = 0; // fully charged  
  document.getElementById("score").innerText = `Score: ${score}`;  
  document.getElementById("high-score").innerText = `High Score: ${highScore}`;  
  requestAnimationFrame(updateGame);  
}  
  
function spawnObstacle(){  
  const width = opponentCarDesign[0].length*PIXEL_SIZE;  
  const height = opponentCarDesign.length*PIXEL_SIZE;  
  const x = Math.random() * (canvas.width - width - 10) + 5;  
  obstacles.push({x: x, y: -height, width: width, height: height, passed: false});  
}  
  
function updateGame(){  
  if(gameOver) return;  
  ctx.clearRect(0,0,canvas.width,canvas.height);  
  
  // Obstacles  
  for(let obs of obstacles){  
    obs.y += obstacleSpeed;  
    drawCar(obs.x, obs.y, opponentCarDesign);  
    if(!obs.passed && obs.y > player.y + player.height){ score++; obs.passed=true; document.getElementById("score").innerText=`Score: ${score}`; }  
  }  
  obstacles = obstacles.filter(o => o.y < canvas.height + 20);  
  if(Math.random() < 0.02) spawnObstacle();  
  
  // Player  
  drawCar(player.x, player.y, playerCarDesign);  
  
  // Collision  
  for(let obs of obstacles){  
    if(player.x < obs.x + obs.width &&  
       player.x + player.width > obs.x &&  
       player.y < obs.y + obs.height &&  
       player.y + player.height > obs.y){  
      endGame(); return;  
    }  
  }  
  
  // Nitro logic  
  if(nitroActive){  
    playerSpeed = playerBaseSpeed * 3;  
    nitroDuration--;  
    updateNitroButton();  
    if(nitroDuration <= 0){  
      nitroActive = false;  
      nitroCooldown = NITRO_COOLDOWN_FRAMES;  
      playerSpeed = playerBaseSpeed;  
    }  
  } else if(nitroCooldown > 0){  
    nitroCooldown--;  
    playerSpeed = playerBaseSpeed;  
    updateNitroButton();  
  }  
  
  // Player movement  
  if(keys["ArrowLeft"]) player.x = Math.max(player.x - playerSpeed, 0);  
  if(keys["ArrowRight"]) player.x = Math.min(player.x + playerSpeed, canvas.width - player.width);  
  
  requestAnimationFrame(updateGame);  
}  
  
function endGame(){  
  gameOver = true;  
  ctx.fillStyle = '#0F0';  
  ctx.font = '20px Arial';  
  ctx.fillText("Game Over!", canvas.width/2-50, canvas.height/2);  
  ctx.fillText(`Score: ${score}`, canvas.width/2-40, canvas.height/2+30);  
  if(score > highScore){ highScore = score; localStorage.setItem("highScore", highScore); }  
  document.getElementById("high-score").innerText = `High Score: ${highScore}`;  
}  
  
// Controls  
document.addEventListener("keydown", e=>{ keys[e.key]=true; });  
document.addEventListener("keyup", e=>{ keys[e.key]=false; });  
  
// Nitro Button Update  
function updateNitroButton(){  
  if(!nitroBtn) return;  
  const ratio = nitroActive ? nitroDuration/NITRO_DURATION_FRAMES : nitroCooldown/NITRO_COOLDOWN_FRAMES;  
  nitroBtn.style.background = `linear-gradient(to top, #00FF00 ${nitroActive? ratio*100 : (1-ratio)*100}%, transparent 0%), url('NitroAbility_icon.png')`;  
  nitroBtn.style.backgroundSize = "cover";  
  nitroBtn.style.backgroundRepeat = "no-repeat";  
}  
  
// Touch Buttons  
function addGameControls(){  
  // Left  
  leftBtn = document.createElement("button");  
  leftBtn.innerText = "‚¨ÖÔ∏è";  
  leftBtn.style.cssText = "position:fixed; bottom:10px; left:10px; width:70px; height:70px; font-size:28px; border-radius:50%; z-index:1000;";  
  leftBtn.addEventListener("touchstart",()=>keys["ArrowLeft"]=true);  
  leftBtn.addEventListener("touchend",()=>keys["ArrowLeft"]=false);  
  document.body.appendChild(leftBtn);  
  
  // Right  
  rightBtn = document.createElement("button");  
  rightBtn.innerText = "‚û°Ô∏è";  
  rightBtn.style.cssText = "position:fixed; bottom:10px; left:90px; width:70px; height:70px; font-size:28px; border-radius:50%; z-index:1000;";  
  rightBtn.addEventListener("touchstart",()=>keys["ArrowRight"]=true);  
  rightBtn.addEventListener("touchend",()=>keys["ArrowRight"]=false);  
  document.body.appendChild(rightBtn);  
  
  // Nitro  
 // Nitro
  nitroBtn = document.createElement("button");
  nitroBtn.style.width = "70px";
  nitroBtn.style.height = "70px";
  nitroBtn.style.position = "fixed";
  nitroBtn.style.bottom = "10px";
  nitroBtn.style.right = "10px";
  nitroBtn.style.border = "none";
  nitroBtn.style.borderRadius = "12px";
  nitroBtn.style.zIndex = "1000";
  nitroBtn.style.background = `linear-gradient(to top, #00FF00 100%, transparent 0%), url('NitroAbility_icon.png')`;
  nitroBtn.style.backgroundSize = "cover";
  nitroBtn.style.backgroundRepeat = "no-repeat";
  nitroBtn.addEventListener("touchstart", ()=>{
    if(!nitroActive && nitroCooldown <= 0){
      nitroActive = true;
      nitroDuration = NITRO_DURATION_FRAMES;
      updateNitroButton();
    }
  });
  document.body.appendChild(nitroBtn);
  updateNitroButton();
}

// Remove buttons when closing game
function removeGameControls(){
  if(leftBtn){ leftBtn.remove(); leftBtn=null; }
  if(rightBtn){ rightBtn.remove(); rightBtn=null; }
  if(nitroBtn){ nitroBtn.remove(); nitroBtn=null; }
}

// Open/Close game
function openGame(){ overlay.style.display="flex"; startGame(); addGameControls(); }
function closeGame(){ overlay.style.display="none"; playerSpeed=playerBaseSpeed; nitroActive=false; nitroCooldown=0; removeGameControls(); }
</script>
</body>
</html>